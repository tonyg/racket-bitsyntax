<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><title>bitsyntax</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="index.html" class="tocviewselflink" data-pltdoc="x">bitsyntax</a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="index.html#%28part._.Introduction%29" class="tocviewlink" data-pltdoc="x">Introduction</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="index.html#%28part._.Changes%29" class="tocviewlink" data-pltdoc="x">Changes</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="index.html#%28part._.What_is_a_bit_string_%29" class="tocviewlink" data-pltdoc="x">What is a bit string?</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="index.html#%28part._.A.P.I%29" class="tocviewlink" data-pltdoc="x">API</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._bitsyntax%29" class="tocsubseclink" data-pltdoc="x">bitsyntax</a></td></tr><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="#%28part._.Introduction%29" class="tocsubseclink" data-pltdoc="x">Introduction</a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#%28part._.Changes%29" class="tocsubseclink" data-pltdoc="x">Changes</a></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="#%28part._.What_is_a_bit_string_%29" class="tocsubseclink" data-pltdoc="x">What is a bit string?</a></td></tr><tr><td><span class="tocsublinknumber">4<tt>&nbsp;</tt></span><a href="#%28part._.A.P.I%29" class="tocsubseclink" data-pltdoc="x">API</a></td></tr><tr><td><span class="tocsublinknumber">4.1<tt>&nbsp;</tt></span><a href="#%28part._.Types%29" class="tocsubseclink" data-pltdoc="x">Types</a></td></tr><tr><td><a href="#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._.Bit.String%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">Bit<span class="mywbr"> &nbsp;</span>String</span></span></a></td></tr><tr><td><span class="tocsublinknumber">4.2<tt>&nbsp;</tt></span><a href="#%28part._.Pattern-matching_bit_strings%29" class="tocsubseclink" data-pltdoc="x">Pattern-<wbr></wbr>matching bit strings</a></td></tr><tr><td><a href="#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-case%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">bit-<wbr></wbr>string-<wbr></wbr>case</span></span></a></td></tr><tr><td><span class="tocsublinknumber">4.3<tt>&nbsp;</tt></span><a href="#%28part._.Assembling_bit_strings_from_pieces%29" class="tocsubseclink" data-pltdoc="x">Assembling bit strings from pieces</a></td></tr><tr><td><a href="#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">bit-<wbr></wbr>string</span></span></a></td></tr><tr><td><span class="tocsublinknumber">4.4<tt>&nbsp;</tt></span><a href="#%28part._integer-layout%29" class="tocsubseclink" data-pltdoc="x">Binary representation of integers</a></td></tr><tr><td><span class="tocsublinknumber">4.5<tt>&nbsp;</tt></span><a href="#%28part._custom-parsers%29" class="tocsubseclink" data-pltdoc="x">Custom parsers and custom formatters</a></td></tr><tr><td><span class="tocsublinknumber">4.5.1<tt>&nbsp;</tt></span><a href="#%28part._.Supplying_arguments_to_custom_parsers_and_formatters%29" class="tocsubseclink" data-pltdoc="x">Supplying arguments to custom parsers and formatters</a></td></tr><tr><td><span class="tocsublinknumber">4.5.2<tt>&nbsp;</tt></span><a href="#%28part._.The_detailed_anatomy_of_a_custom_extension%29" class="tocsubseclink" data-pltdoc="x">The detailed anatomy of a custom extension</a></td></tr><tr><td><span class="tocsublinknumber">4.6<tt>&nbsp;</tt></span><a href="#%28part._.Bit_string_utilities%29" class="tocsubseclink" data-pltdoc="x">Bit string utilities</a></td></tr><tr><td><a href="#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">bit-<wbr></wbr>string?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-length%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">bit-<wbr></wbr>string-<wbr></wbr>length</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-empty~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">bit-<wbr></wbr>string-<wbr></wbr>empty?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-equal~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">bit-<wbr></wbr>string-<wbr></wbr>equal?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-append%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">bit-<wbr></wbr>string-<wbr></wbr>append</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-split-at%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">bit-<wbr></wbr>string-<wbr></wbr>split-<wbr></wbr>at</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-split-at-or-false%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">bit-<wbr></wbr>string-<wbr></wbr>split-<wbr></wbr>at-<wbr></wbr>or-<wbr></wbr>false</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-take%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">bit-<wbr></wbr>string-<wbr></wbr>take</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-drop%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">bit-<wbr></wbr>string-<wbr></wbr>drop</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._sub-bit-string%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">sub-<wbr></wbr>bit-<wbr></wbr>string</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-ref%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">bit-<wbr></wbr>string-<wbr></wbr>ref</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-~3ebytes%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">bit-<wbr></wbr>string-<wbr></wbr>&gt;bytes</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-~3ebytes%2Falign%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">bit-<wbr></wbr>string-<wbr></wbr>&gt;bytes/<span class="mywbr"> &nbsp;</span>align</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-byte-count%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">bit-<wbr></wbr>string-<wbr></wbr>byte-<wbr></wbr>count</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-pack%21%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">bit-<wbr></wbr>string-<wbr></wbr>pack!</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-pack%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">bit-<wbr></wbr>string-<wbr></wbr>pack</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._copy-bits%21%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">copy-<wbr></wbr>bits!</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-~3einteger%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">bit-<wbr></wbr>string-<wbr></wbr>&gt;integer</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-~3ebyte%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">bit-<wbr></wbr>string-<wbr></wbr>&gt;byte</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-~3esigned-integer%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">bit-<wbr></wbr>string-<wbr></wbr>&gt;signed-<wbr></wbr>integer</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-~3eunsigned-integer%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">bit-<wbr></wbr>string-<wbr></wbr>&gt;unsigned-<wbr></wbr>integer</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._integer-~3ebit-string%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">integer-<wbr></wbr>&gt;bit-<wbr></wbr>string</span></span></a></td></tr><tr><td><span class="tocsublinknumber">4.7<tt>&nbsp;</tt></span><a href="#%28part._.Debugging_utilities%29" class="tocsubseclink" data-pltdoc="x">Debugging utilities</a></td></tr><tr><td><a href="#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-slice~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">bit-<wbr></wbr>slice?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-slice-binary%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">bit-<wbr></wbr>slice-<wbr></wbr>binary</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-slice-low-bit%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">bit-<wbr></wbr>slice-<wbr></wbr>low-<wbr></wbr>bit</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-slice-high-bit%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">bit-<wbr></wbr>slice-<wbr></wbr>high-<wbr></wbr>bit</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._splice~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">splice?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._splice-left%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">splice-<wbr></wbr>left</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._splice-right%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">splice-<wbr></wbr>right</span></span></a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="versionNoNav">5.0</span></div><h2><a name="(part._bitsyntax)"></a>bitsyntax</h2><div class="SAuthorListBox"><span class="SAuthorList"><p class="author">Tony Garnock-Jones &lt;<a href="mailto:tonygarnockjones@gmail.com">tonygarnockjones@gmail.com</a>&gt;</p></span></div><h3>1<tt>&nbsp;</tt><a name="(part._.Introduction)"></a>Introduction</h3><p>This library adds three features to Racket:</p><ul><li><p>library support for <span style="font-style: italic">bit strings</span>, a generalization of
byte vectors;</p></li><li><p>syntactic support for extracting integers, floats,
sub-bit-strings and general values from bit strings;
and</p></li><li><p>syntactic support for constructing bit strings from integers,
floats, other bit strings and general values.</p></li></ul><p>It is heavily inspired by Erlang&rsquo;s binaries, bitstrings, and binary
pattern-matching. The Erlang documentation provides a good
introduction to these features:</p><ul><li><p><a href="http://www.erlang.org/doc/reference_manual/expressions.html#id80332">Bit
syntax expressions</a> in the Erlang Reference Manual</p></li><li><p><a href="http://www.erlang.org/doc/programming_examples/bit_syntax.html">Bit
syntax</a> in the Programming Examples Manual</p></li></ul><p>The binary matching (<span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-case%29%29" class="RktStxLink" data-pltdoc="x">bit-string-case</a></span>) and formatting
(<span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string%29%29" class="RktStxLink" data-pltdoc="x">bit-string</a></span>) languages can also be extended with custom
parsers and formatters, giving lightweight syntactic support for
domain-specific binary encodings of values.</p><p>If you find that this library lacks some feature you need, or you have
a suggestion for improving it, please don&rsquo;t hesitate to
<a href="mailto:tonygarnockjones@gmail.com">get in touch with me</a>!</p><h3>2<tt>&nbsp;</tt><a name="(part._.Changes)"></a>Changes</h3><p>Version 5.0 of this library repaired translation between little-endian
integers and bit-strings of width not equal to a multiple of 8 bits.
Previously, the high bits of such integers were placed in an incorrect
position; see <a href="index.html#%28part._integer-layout%29" data-pltdoc="x">Binary representation of integers</a> for details. This brings the
behaviour of the library into line with Erlang. Since the change may
affect existing programs, it warrants an incremented major version
number.</p><p>Version 4.1 of this library adds <span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-take%29%29" class="RktValLink" data-pltdoc="x">bit-string-take</a></span> and
<span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-drop%29%29" class="RktValLink" data-pltdoc="x">bit-string-drop</a></span>, and causes the empty bit-string to be
treated as an identity in <span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-append%29%29" class="RktValLink" data-pltdoc="x">bit-string-append</a></span>.</p><p>Version 4.0 of this library changes the way custom parsers and
formatters work, requiring them to be macros, where in previous
releases they could have been implemented as functions. Version 4.0 of
the library also supports the use of <span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-case%29%29" class="RktStxLink" data-pltdoc="x">bit-string-case</a></span> and
<span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string%29%29" class="RktStxLink" data-pltdoc="x">bit-string</a></span> in Typed Racket code.</p><p>Version 4.0 is also the final release made using the Planet package
system. Current and future versions of this package will use the new
Racket package system ("<span class="stt">raco pkg</span>") instead.</p><p>Version 3.2 of this library adds support for custom parsers and
formatters.</p><p>Version 3.0 of this library uses <span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span> instead of <span class="RktSym">:</span> to
separate expressions from encoding specifications in the
<span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-case%29%29" class="RktStxLink" data-pltdoc="x">bit-string-case</a></span> and <span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string%29%29" class="RktStxLink" data-pltdoc="x">bit-string</a></span> macros. The reason
for this is to avoid a collision with Typed Racket, which uses
<span class="RktSym">:</span> for its own purposes.</p><h3>3<tt>&nbsp;</tt><a name="(part._.What_is_a_bit_string_)"></a>What is a bit string?</h3><p>A bit string is a sequence of bits, numbered ascending from zero. The
first byte is bits 0 through 7 inclusive, where bit 0 is the
<span style="font-style: italic">most</span> significant bit in the byte; the second byte is bits 8
through 15; and so on.</p><p>Concretely, a bit string is either</p><ul><li><p>a byte vector, as returned by <span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes%29%29" class="RktValLink" data-pltdoc="x">bytes</a></span> and friends;</p></li><li><p>a bit-resolution slice of a byte vector, as returned by
<span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._sub-bit-string%29%29" class="RktValLink" data-pltdoc="x">sub-bit-string</a></span>;
or</p></li><li><p>a splicing-together of two bit strings, as returned by
<span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-append%29%29" class="RktValLink" data-pltdoc="x">bit-string-append</a></span>.</p></li></ul><p>The routines in this library are written, except where specified, to
handle any of these three representations for bit strings.</p><p>If you need to flatten a bit string into a contiguous sequence of
whole bytes, use <span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-~3ebytes%29%29" class="RktValLink" data-pltdoc="x">bit-string-&gt;bytes</a></span> or
<span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-~3ebytes%2Falign%29%29" class="RktValLink" data-pltdoc="x">bit-string-&gt;bytes/align</a></span>.</p><h3>4<tt>&nbsp;</tt><a name="(part._.A.P.I)"></a><a name="(mod-path._bitsyntax)"></a>API</h3><p>All the functionality below can be accessed with a single
<span class="RktSym"><a href="http://docs.racket-lang.org/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span>:</p><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="index.html#%28mod-path._bitsyntax%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">bitsyntax</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <span class="stt">bitsyntax</span></span></td></tr></table></p><h4>4.1<tt>&nbsp;</tt><a name="(part._.Types)"></a>Types</h4><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><a name="(form._((lib._bitsyntax/main..rkt)._.Bit.String))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._.Bit.String%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">BitString</a></span></span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">The Typed Racket type of bit strings. A value
has type <span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._.Bit.String%29%29" class="RktStxLink" data-pltdoc="x">BitString</a></span> if and only if it also results in
<span class="RktVal">#t</span> when given to <span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span>.</div></p><h4>4.2<tt>&nbsp;</tt><a name="(part._.Pattern-matching_bit_strings)"></a>Pattern-matching bit strings</h4><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._bitsyntax/main..rkt)._bit-string-case))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-case%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">bit-string-case</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">value-expr</span><span class="hspace">&nbsp;</span><span class="RktVar">clause</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="specgrammar"><tr><td align="right" valign="baseline"><span class="RktVar">clause</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktVar">segment-pattern</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/when_unless.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._when%29%29" class="RktStxLink" data-pltdoc="x">when</a></span><span class="hspace">&nbsp;</span><span class="RktVar">guard-expr</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktVar">body-expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktVar">segment-pattern</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktVar">body-expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktVar">body-expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">segment-pattern</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">comparison-pattern</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">binding-pattern</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">discard-pattern</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">comparison-pattern</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">custom-parser</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">option</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">binding-pattern</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">custom-parser</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">option</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktVar">id</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">id</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">discard-pattern</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">custom-parser</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">option</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">custom-parser</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktVar">expr</span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">option</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">type-option</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">signedness-option</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">endianness-option</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">width-option</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">type-option</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktSym">integer</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktSym">float</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktSym">binary</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">signedness-option</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktSym">unsigned</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktSym">signed</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">endianness-option</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktSym">little-endian</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktSym">big-endian</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktSym">native-endian</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">width-option</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktSym">bits</span><span class="hspace">&nbsp;</span><span class="RktVar">n</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes%29%29" class="RktValLink" data-pltdoc="x">bytes</a></span><span class="hspace">&nbsp;</span><span class="RktVar">n</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktSym">default</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">The <span class="RktVar">value-expr</span> is evaluated first. It must evaluate to a bit
string&#8212;<wbr></wbr>any object for which <span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span> would return
<span class="RktVal">#t</span>.</div></p><p>Each <span class="RktVar">clause</span> is then tried in turn. The first succeeding
clause determines the result of the whole expression. A clause matches
successfully if all its <span class="RktVar">segment-pattern</span>s match some portion
of the input, there is no unused input left over at the end, and the
<span class="RktVar">guard-expr</span> (if there is one) evaluates to a true value. If a
<span class="RktVar">clause</span> succeeds, then <span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/begin.html#%28form._%28%28quote._~23~25kernel%29._begin%29%29" class="RktStxLink" data-pltdoc="x">begin</a></span><span class="stt"> </span><span class="RktVar">body-expr</span><span class="stt"> </span><span class="RktMeta"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span> is
evaluated, and its result becomes the result of the whole expression.</p><p>If none of the <span class="RktVar">clause</span>s succeed, and there is an <span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span>
clause, its <span class="RktVar">body-expr</span>s are evaluated and returned. If there&rsquo;s
no <span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span> clause and none of the others succeed, an error is
signalled.</p><p>Each <span class="RktVar">segment-pattern</span> matches zero or more <span style="font-style: italic">bits</span> of
the input bit string. The given type, signedness, endianness and width
are used to extract a value from the bit string, at which point it is
either compared to some other value using <span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._equal~3f%29%29" class="RktValLink" data-pltdoc="x">equal?</a></span> (if a
<span class="RktVar">comparison-pattern</span> was used in the segment-pattern), bound to
a pattern variable (if a <span class="RktVar">binding-pattern</span> was used), or
discarded (if a <span class="RktVar">discard-pattern</span> was used) before matching
continues with the next <span class="RktVar">segment-pattern</span>.</p><p>The supported segment types are</p><ul><li><p><span class="RktSym">integer</span> &ndash; this is the default. A signed or unsigned,
big- or little-endian integer of the given width in bits is read out
of the bit string. Unless otherwise specified, integers default to
big-endian, unsigned, and <span style="font-weight: bold">eight bits wide</span>. Any width, not just
multiples of eight, is supported. See <a href="index.html#%28part._integer-layout%29" data-pltdoc="x">Binary representation of integers</a> for details.</p></li><li><p><span class="RktSym">float</span> &ndash; A 32- or 64-bit float in either big- or
little-endian byte order is read out of the bit string using
<span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._floating-point-bytes-~3ereal%29%29" class="RktValLink" data-pltdoc="x">floating-point-bytes-&gt;real</a></span>. Unless otherwise specified,
floats default to big-endian and 64 bits wide. Widths other than 32 or
64 bits are unsupported.</p></li><li><p><span class="RktSym">binary</span> &ndash; A sub-bit-string is read out of the bit
string. The bit string can be an arbitrary number of bits long, not
just a multiple of eight. Unless otherwise specified, the entire rest
of the input will be consumed and returned.</p></li><li><p><span class="RktVar">custom-parser</span> &ndash; An arbitrary amount of the input is
consumed, analysed, and transformed. The built-in parsing options
can&rsquo;t be specified in conjunction with a custom parser: instead, each
custom parser accepts its own option arguments. See
<a href="index.html#%28part._custom-parsers%29" data-pltdoc="x">Custom parsers and custom formatters</a>.</p></li></ul><p>Each type (except for <span class="RktVar">custom-parser</span>) has a default
signedness, endianness, and width in bits, as described above. These
can all (again, except for <span class="RktVar">custom-parser</span>s, which manage such
issues on their own) be overridden individually:</p><ul><li><p><span class="RktSym">unsigned</span> and <span class="RktSym">signed</span> specify that integers
should be decoded in an unsigned or signed manner, respectively.</p></li><li><p><span class="RktSym">big-endian</span>, <span class="RktSym">little-endian</span> and
<span class="RktSym">native-endian</span> specify the endianness to use in decoding
integers or floats. Specifying <span class="RktSym">native-endian</span> causes Racket
to use whatever is the native endianness of the platform the program
is currently running on (discovered using
<span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._system-big-endian~3f%29%29" class="RktValLink" data-pltdoc="x">system-big-endian?</a></span>).</p></li><li><p><span class="RktSym">default</span> causes the decoder to use whatever the
default width is for the type specified.</p></li><li><p><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes%29%29" class="RktValLink" data-pltdoc="x">bytes</a></span><span class="stt"> </span><span class="RktVar">n</span> causes the decoder to try to consume
<span class="RktVar">n</span> bytes of input for this segment-pattern.</p></li><li><p><span class="RktSym">bits</span><span class="stt"> </span><span class="RktVar">n</span> causes the decoder to try to consume
<span class="RktVar">n</span> bits of input for this segment-pattern.</p></li></ul><p>For example:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-case%29%29" class="RktStxLink" data-pltdoc="x">bit-string-case</a></span><span class="hspace">&nbsp;</span><span class="RktSym">some-input-value</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes%29%29" class="RktValLink" data-pltdoc="x">bytes</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">a</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">bits</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">binary</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/when_unless.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._when%29%29" class="RktStxLink" data-pltdoc="x">when</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._~3c%29%29" class="RktValLink" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktVal">123</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._~3e~3d%29%29" class="RktValLink" data-pltdoc="x">&gt;=</a></span><span class="hspace">&nbsp;</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktVal">100</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">between-100-and-123</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">bits</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">bits</span><span class="hspace">&nbsp;</span><span class="RktVal">6</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktSym">f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">bits</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">bits</span><span class="hspace">&nbsp;</span><span class="RktVal">6</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28lib._racket%2Flist..rkt%29._rest%29%29" class="RktValLink" data-pltdoc="x">rest</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">binary</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28lib._racket%2Flist..rkt%29._rest%29%29" class="RktValLink" data-pltdoc="x">rest</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>This expression analyses <span class="RktSym">some-input-value</span>, which must be a
<span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span><span class="RktPn">)</span>. It may contain:</p><ul><li><p>16 zero bits, in which case the result is <span class="RktVal">'</span><span class="RktVal">a</span>;
or</p></li><li><p>a ten-bit big-endian unsigned integer followed by 6 bits which
are ignored, where the integer is between 100 (inclusive) and
123 (exclusive), in which case the result is
<span class="RktVal">'</span><span class="RktVal">between-100-and-123</span>;
or</p></li><li><p>the same as the previous clause, but without the guard;
if this succeeds, the result is the ten-bit integer itself;
or</p></li><li><p>the same as the previous clause, but with an arbitrary number
of bits following the six discarded bits. The result here is a list
containing the ten-bit integer and the trailing bit string.</p></li></ul><p>The following code block parses a Pascal-style byte string (one length
byte, followed by the right number of data bytes) and decodes it using
a UTF-8 codec:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-case%29%29" class="RktStxLink" data-pltdoc="x">bit-string-case</a></span><span class="hspace">&nbsp;</span><span class="RktSym">input-bit-string</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">len</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">binary</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes%29%29" class="RktValLink" data-pltdoc="x">bytes</a></span><span class="hspace">&nbsp;</span><span class="RktSym">len</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes-~3estring%2Futf-8%29%29" class="RktValLink" data-pltdoc="x">bytes-&gt;string/utf-8</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-pack%29%29" class="RktValLink" data-pltdoc="x">bit-string-pack</a></span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Notice how the <span class="RktSym">len</span> value, which came from the input bit
string itself, is used to decide how much of the remaining input to
consume.</p><h4>4.3<tt>&nbsp;</tt><a name="(part._.Assembling_bit_strings_from_pieces)"></a>Assembling bit strings from pieces</h4><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._bitsyntax/main..rkt)._bit-string))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">bit-string</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">spec</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="specgrammar"><tr><td align="right" valign="baseline"><span class="RktVar">spec</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">[</span><span class="RktVar">segment-expr</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">custom-formatter</span><span class="RktPn">]</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">[</span><span class="RktVar">segment-expr</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">option</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">]</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">segment-expr</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">custom-formatter</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktVar">expr</span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">option</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">type-option</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">endianness-option</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">width-option</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">type-option</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktSym">integer</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktSym">float</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktSym">binary</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">endianness-option</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktSym">little-endian</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktSym">big-endian</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktSym">native-endian</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">width-option</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktSym">bits</span><span class="hspace">&nbsp;</span><span class="RktVar">n</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes%29%29" class="RktValLink" data-pltdoc="x">bytes</a></span><span class="hspace">&nbsp;</span><span class="RktVar">n</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktSym">default</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">This form assembles and encodes a collection of values into a single
bit string. Each of the zero or more <span class="RktVar">spec</span>s supplies zero or
more bits of the resulting bit string. The core language supports
encoding of integers, floating-point numbers, and bit-strings, and
custom formatters (see <a href="index.html#%28part._custom-parsers%29" data-pltdoc="x">Custom parsers and custom formatters</a>) can be used to give a
convenient syntax for encoding other kinds of value.</div></p><p>Each <span class="RktVar">spec</span> can specify an integer or floating-point number to
encode, a bit string to copy into the output, or a custom formatting
routine to apply to the given value. If a type is not specified,
<span class="RktSym">integer</span> is assumed. If an endianness is (relevant but) not
specified, <span class="RktSym">big-endian</span> is assumed. If a width is not given,
<span class="RktSym">integer</span>s are encoded as 8-bit quantities, <span class="RktSym">float</span>s are
encoded as 64-bit quantities, and <span class="RktSym">binary</span> objects are copied
into the output in their entirety. Custom formatters do not accept
these options, since they manage the encoding of the value they are
given themselves, and take whatever options they need by other means.</p><p>If a width is specified, integers will be truncated or sign-extended
to fit, and binaries will be truncated. If a binary is shorter than a
specified width, an error is signalled. Floating-point encoding can
only be done using 32- or 64-bit widths, but integer encoding can be
done using any bit width; see <a href="index.html#%28part._integer-layout%29" data-pltdoc="x">Binary representation of integers</a> for details.</p><p>For example:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">string-&gt;pascal/utf-8</span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/let.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._let%29%29" class="RktStxLink" data-pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">bs</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._string-~3ebytes%2Futf-8%29%29" class="RktValLink" data-pltdoc="x">string-&gt;bytes/utf-8</a></span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string%29%29" class="RktStxLink" data-pltdoc="x">bit-string</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes-length%29%29" class="RktValLink" data-pltdoc="x">bytes-length</a></span><span class="hspace">&nbsp;</span><span class="RktSym">bs</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">bs</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">binary</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>This subroutine encodes its string argument using a UTF-8 codec, and
then assembles it into a Pascal-style string with a prefix length
byte. If the encoded string is longer than 255 bytes, note that the
length byte will be truncated and so the encoding will be incorrect. A
better encoder would ensure that <span class="RktSym">bs</span> was not longer than 255
bytes before encoding it as a Pascal string.</p><p>Note that if you wish to leave all the options at their defaults (that
is, <span class="RktPn">[</span><span class="RktMeta"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="stt"> </span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="stt"> </span><span class="RktSym">integer</span><span class="stt"> </span><span class="RktSym">bits</span><span class="stt"> </span><span class="RktVal">8</span><span class="RktPn">]</span>), you can use the second form of
<span class="RktVar">spec</span> given above.</p><h4>4.4<tt>&nbsp;</tt><a name="(part._integer-layout)"></a>Binary representation of integers</h4><p>Bits in a bit-string are always counted off from the MSB of a byte to
the LSB rather than the other way around.</p><p>Endianness (when converting between bit-strings and integers) only
affects which group of eight bits is dealt with first. In big-endian
mode, bits are copied out in order from big end to little end, so an
integer value with bits <span class="stt">ABCDEFGHIJKL</span> will lead to bits appearing
in that order in the result. In little-endian mode, bits are copied
out from MSB to LSB as usual, but the lowest eight bits of the integer
are copied first, followed by the next byte&rsquo;s worth, and so on, so
<span class="stt">ABCDEFGHIJKL</span> will appear as <span class="stt">EFGHIJKLABCD</span> in the resulting
bit-string.</p><p>For multiples of eight bits aligned to byte boundaries, the usual
endianness conversions follow:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">705 = 0000001011000001 ---&gt; 1100000100000010 in little-endian</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">0</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">2</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">C</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">1</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">C</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">1</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">0</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">2</span></p></td></tr></table></p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">bytes-&gt;hex-string</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-~3ebytes%29%29" class="RktValLink" data-pltdoc="x">bit-string-&gt;bytes</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string%29%29" class="RktStxLink" data-pltdoc="x">bit-string</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVal">705</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">big-endian</span><span class="hspace">&nbsp;</span><span class="RktSym">bits</span><span class="hspace">&nbsp;</span><span class="RktVal">16</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">"02c1"</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">bytes-&gt;hex-string</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-~3ebytes%29%29" class="RktValLink" data-pltdoc="x">bit-string-&gt;bytes</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string%29%29" class="RktStxLink" data-pltdoc="x">bit-string</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVal">705</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">little-endian</span><span class="hspace">&nbsp;</span><span class="RktSym">bits</span><span class="hspace">&nbsp;</span><span class="RktVal">16</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">"c102"</span></p></td></tr></table></blockquote><p>However, when other integer widths are used, little-endian conversion
of values longer than eight bits can be surprising. For example, let&rsquo;s
first examine encoding the number 48 as a 6-bit integer followed by
705 as a 10-bit integer in big-endian:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">48</span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">= 110000xx</span></p></td></tr><tr><td><p><span class="stt">705 = 10110000 01xxxxxx</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">110000 10110000 01 = resulting bitstring</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">C</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">2</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">C</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">1</span></p></td></tr></table></p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">bytes-&gt;hex-string</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-~3ebytes%29%29" class="RktValLink" data-pltdoc="x">bit-string-&gt;bytes</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string%29%29" class="RktStxLink" data-pltdoc="x">bit-string</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVal">48</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">big-endian</span><span class="hspace">&nbsp;</span><span class="RktSym">bits</span><span class="hspace">&nbsp;</span><span class="RktVal">6</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktVal">705</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">big-endian</span><span class="hspace">&nbsp;</span><span class="RktSym">bits</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><span class="RktRes">"c2c1"</span></p></td></tr></table></blockquote><p>Encoding the same numbers with the same widths in little-endian, we
see that the low byte of the 10-bit value is streamed immediately
following the bits of the 6-bit value, followed by the remainder of
the 10-bit value:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">48</span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">=</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">xx110000 ---&gt; 110000xx</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">in little-endian</span></p></td></tr><tr><td><p><span class="stt">705 = xxxxxx10 11000001 ---&gt; 11000001 10xxxxxx</span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">in little-endian</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">110000 11000001 10 = resulting bitstring</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">C</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">3</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">0</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">6</span></p></td></tr></table></p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">bytes-&gt;hex-string</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-~3ebytes%29%29" class="RktValLink" data-pltdoc="x">bit-string-&gt;bytes</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string%29%29" class="RktStxLink" data-pltdoc="x">bit-string</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVal">48</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">little-endian</span><span class="hspace">&nbsp;</span><span class="RktSym">bits</span><span class="hspace">&nbsp;</span><span class="RktVal">6</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktVal">705</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">little-endian</span><span class="hspace">&nbsp;</span><span class="RktSym">bits</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><span class="RktRes">"c306"</span></p></td></tr></table></blockquote><p>Finally, here is an example of a multiple of eight bits that is not
aligned to a byte boundary. We will encode 47574 as a 16-bit quantity,
padded with four zero bits on each side. First, in big-endian:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">47574 = 10111001 11010110</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">0000 10111001 11010110 0000 = result</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">0</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">B</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">9</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">D</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">6</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">0</span></p></td></tr></table></p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">bytes-&gt;hex-string</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-~3ebytes%29%29" class="RktValLink" data-pltdoc="x">bit-string-&gt;bytes</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string%29%29" class="RktStxLink" data-pltdoc="x">bit-string</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">big-endian</span><span class="hspace">&nbsp;</span><span class="RktSym">bits</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktVal">47574</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">big-endian</span><span class="hspace">&nbsp;</span><span class="RktSym">bits</span><span class="hspace">&nbsp;</span><span class="RktVal">16</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">big-endian</span><span class="hspace">&nbsp;</span><span class="RktSym">bits</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><span class="RktRes">"0b9d60"</span></p></td></tr></table></blockquote><p>And second, in little-endian:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">47574 = 10111001 11010110 ---&gt; 11010110 10111001</span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">in little-endian</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">0000 11010110 10111001 0000 = result</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">0</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">D</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">6</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">B</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">9</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">0</span></p></td></tr></table></p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">bytes-&gt;hex-string</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-~3ebytes%29%29" class="RktValLink" data-pltdoc="x">bit-string-&gt;bytes</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string%29%29" class="RktStxLink" data-pltdoc="x">bit-string</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">little-endian</span><span class="hspace">&nbsp;</span><span class="RktSym">bits</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktVal">47574</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">little-endian</span><span class="hspace">&nbsp;</span><span class="RktSym">bits</span><span class="hspace">&nbsp;</span><span class="RktVal">16</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">little-endian</span><span class="hspace">&nbsp;</span><span class="RktSym">bits</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><span class="RktRes">"0d6b90"</span></p></td></tr></table></blockquote><h4>4.5<tt>&nbsp;</tt><a name="(part._custom-parsers)"></a>Custom parsers and custom formatters</h4><p>For simple uses of <span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-case%29%29" class="RktStxLink" data-pltdoc="x">bit-string-case</a></span> and <span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string%29%29" class="RktStxLink" data-pltdoc="x">bit-string</a></span>,
the built-in parsers and formatters will often be enough. Many binary
data formats, however, make heavy use of domain-specific value
encodings, and it quickly becomes either repetitive or awkward and
error-prone to express these domain-specific formats. Custom parsers
and custom formatters exist to allow you to extend both
<span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-case%29%29" class="RktStxLink" data-pltdoc="x">bit-string-case</a></span> and <span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string%29%29" class="RktStxLink" data-pltdoc="x">bit-string</a></span> to provide convenient
shortcut syntax for domain-specific data formats.</p><p>For example, imagine a particular protocol makes heavy use of
Pascal-style strings: sequences of UTF-8 encoded bytes prefixed by a
single length byte, intrinsically limited to a maximum length of 255
bytes. Performing the necessary checks and transformations quickly
gets repetitive, as you can see:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-case%29%29" class="RktStxLink" data-pltdoc="x">bit-string-case</a></span><span class="hspace">&nbsp;</span><span class="RktSym">packet</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktSym">PACKET-TYPE-ONE</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">username-length</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">raw-username</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">binary</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes%29%29" class="RktValLink" data-pltdoc="x">bytes</a></span><span class="hspace">&nbsp;</span><span class="RktSym">username-length</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">password-length</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">raw-password</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">binary</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes%29%29" class="RktValLink" data-pltdoc="x">bytes</a></span><span class="hspace">&nbsp;</span><span class="RktSym">password-length</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/let.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._let%29%29" class="RktStxLink" data-pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">username</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes-~3estring%2Futf-8%29%29" class="RktValLink" data-pltdoc="x">bytes-&gt;string/utf-8</a></span><span class="hspace">&nbsp;</span><span class="RktSym">raw-username</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">password</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes-~3estring%2Futf-8%29%29" class="RktValLink" data-pltdoc="x">bytes-&gt;string/utf-8</a></span><span class="hspace">&nbsp;</span><span class="RktSym">raw-password</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktSym">PACKET-TYPE-TWO</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">error-code</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">big-endian</span><span class="hspace">&nbsp;</span><span class="RktSym">integer</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes%29%29" class="RktValLink" data-pltdoc="x">bytes</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">error-text-length</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">raw-error-text</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">binary</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes%29%29" class="RktValLink" data-pltdoc="x">bytes</a></span><span class="hspace">&nbsp;</span><span class="RktSym">error-text-length</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/let.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._let%29%29" class="RktStxLink" data-pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">error-text</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes-~3estring%2Futf-8%29%29" class="RktValLink" data-pltdoc="x">bytes-&gt;string/utf-8</a></span><span class="hspace">&nbsp;</span><span class="RktSym">raw-error-text</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr></table></blockquote><p>On the formatting side, things are just as bad:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">encode-packet-type-one</span><span class="hspace">&nbsp;</span><span class="RktSym">username</span><span class="hspace">&nbsp;</span><span class="RktSym">password</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/let.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._let%29%29" class="RktStxLink" data-pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">raw-username</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._string-~3ebytes%2Futf-8%29%29" class="RktValLink" data-pltdoc="x">string-&gt;bytes/utf-8</a></span><span class="hspace">&nbsp;</span><span class="RktSym">username</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">raw-password</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._string-~3ebytes%2Futf-8%29%29" class="RktValLink" data-pltdoc="x">string-&gt;bytes/utf-8</a></span><span class="hspace">&nbsp;</span><span class="RktSym">password</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/when_unless.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._when%29%29" class="RktStxLink" data-pltdoc="x">when</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._~3e%29%29" class="RktValLink" data-pltdoc="x">&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes-length%29%29" class="RktValLink" data-pltdoc="x">bytes-length</a></span><span class="hspace">&nbsp;</span><span class="RktSym">raw-username</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">255</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/exns.html#%28def._%28%28quote._~23~25kernel%29._error%29%29" class="RktValLink" data-pltdoc="x">error</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">encode-packet-type-one</span><span class="hspace">&nbsp;</span><span class="RktVal">"Username too long"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/when_unless.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._when%29%29" class="RktStxLink" data-pltdoc="x">when</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._~3e%29%29" class="RktValLink" data-pltdoc="x">&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes-length%29%29" class="RktValLink" data-pltdoc="x">bytes-length</a></span><span class="hspace">&nbsp;</span><span class="RktSym">raw-password</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">255</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/exns.html#%28def._%28%28quote._~23~25kernel%29._error%29%29" class="RktValLink" data-pltdoc="x">error</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">encode-packet-type-one</span><span class="hspace">&nbsp;</span><span class="RktVal">"Password too long"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string%29%29" class="RktStxLink" data-pltdoc="x">bit-string</a></span><span class="hspace">&nbsp;</span><span class="RktSym">PACKET-TYPE-ONE</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes-length%29%29" class="RktValLink" data-pltdoc="x">bytes-length</a></span><span class="hspace">&nbsp;</span><span class="RktSym">raw-username</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">raw-username</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">binary</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes-length%29%29" class="RktValLink" data-pltdoc="x">bytes-length</a></span><span class="hspace">&nbsp;</span><span class="RktSym">raw-password</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">raw-password</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">binary</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>By introducing a custom extension, comprising both a parser and
formatter together, we can improve the situation enormously:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define-syntax%29%29" class="RktStxLink" data-pltdoc="x">define-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktSym">pascal-string/utf-8</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._syntax-rules%29%29" class="RktStxLink" data-pltdoc="x">syntax-rules</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29.__%29%29" class="RktStxLink" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#t</span><span class="hspace">&nbsp;</span><span class="RktSym">input</span><span class="hspace">&nbsp;</span><span class="RktSym">ks</span><span class="hspace">&nbsp;</span><span class="RktSym">kf</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">The first argument to the custom parser/formatter</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">will be a literal #t to signal it is being used</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">as a parser.</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-case%29%29" class="RktStxLink" data-pltdoc="x">bit-string-case</a></span><span class="hspace">&nbsp;</span><span class="RktSym">input</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">len</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">binary</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes%29%29" class="RktValLink" data-pltdoc="x">bytes</a></span><span class="hspace">&nbsp;</span><span class="RktSym">len</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28lib._racket%2Flist..rkt%29._rest%29%29" class="RktValLink" data-pltdoc="x">rest</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">binary</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ks</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes-~3estring%2Futf-8%29%29" class="RktValLink" data-pltdoc="x">bytes-&gt;string/utf-8</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-~3ebytes%29%29" class="RktValLink" data-pltdoc="x">bit-string-&gt;bytes</a></span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28lib._racket%2Flist..rkt%29._rest%29%29" class="RktValLink" data-pltdoc="x">rest</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">kf</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29.__%29%29" class="RktStxLink" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">The first argument to the custom parser/formatter</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">will be a literal #f to signal it is being used</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">as a formatter.</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/let.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._let%2A%29%29" class="RktStxLink" data-pltdoc="x">let*</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">bs</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._string-~3ebytes%2Futf-8%29%29" class="RktValLink" data-pltdoc="x">string-&gt;bytes/utf-8</a></span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">len</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes-length%29%29" class="RktValLink" data-pltdoc="x">bytes-length</a></span><span class="hspace">&nbsp;</span><span class="RktSym">bs</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/when_unless.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._when%29%29" class="RktStxLink" data-pltdoc="x">when</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._~3e%29%29" class="RktValLink" data-pltdoc="x">&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">len</span><span class="hspace">&nbsp;</span><span class="RktVal">255</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/exns.html#%28def._%28%28quote._~23~25kernel%29._error%29%29" class="RktValLink" data-pltdoc="x">error</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">pascal-string/utf-8</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"String of length ~v too long; max is 255 bytes"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">len</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string%29%29" class="RktStxLink" data-pltdoc="x">bit-string</a></span><span class="hspace">&nbsp;</span><span class="RktSym">len</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">bs</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">binary</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>This single definition can now be used in any <span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-case%29%29" class="RktStxLink" data-pltdoc="x">bit-string-case</a></span>
or <span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string%29%29" class="RktStxLink" data-pltdoc="x">bit-string</a></span> expression where it is in scope. Here&rsquo;s the
earlier example, rewritten to use <span class="RktSym">pascal-string/utf-8</span>:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-case%29%29" class="RktStxLink" data-pltdoc="x">bit-string-case</a></span><span class="hspace">&nbsp;</span><span class="RktSym">packet</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktSym">PACKET-TYPE-ONE</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">username</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">pascal-string/utf-8</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">password</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">pascal-string/utf-8</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktSym">PACKET-TYPE-TWO</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">error-code</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">big-endian</span><span class="hspace">&nbsp;</span><span class="RktSym">integer</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes%29%29" class="RktValLink" data-pltdoc="x">bytes</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">error-text</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">pascal-string/utf-8</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr></table></blockquote><p>Formatting is likewise much simplified:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">encode-packet-type-one</span><span class="hspace">&nbsp;</span><span class="RktSym">username</span><span class="hspace">&nbsp;</span><span class="RktSym">password</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string%29%29" class="RktStxLink" data-pltdoc="x">bit-string</a></span><span class="hspace">&nbsp;</span><span class="RktSym">PACKET-TYPE-ONE</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">username</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">pascal-string/utf-8</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">password</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">pascal-string/utf-8</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><h5>4.5.1<tt>&nbsp;</tt><a name="(part._.Supplying_arguments_to_custom_parsers_and_formatters)"></a>Supplying arguments to custom parsers and formatters</h5><p>Custom parser/formatters must be macros that accept one or more
arguments. The first argument is a boolean flag, supplied as
<span class="RktVal">#t</span> by <span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-case%29%29" class="RktStxLink" data-pltdoc="x">bit-string-case</a></span> or as <span class="RktVal">#f</span> by
<span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string%29%29" class="RktStxLink" data-pltdoc="x">bit-string</a></span>, indicating whether the custom extension is being
used as a parser or a formatter, respectively. Following the flag,</p><ul><li><p>parsers (<span class="RktVal">#t</span>) are given the remaining <span class="RktSym">input</span>
to be parsed, a success continuation function <span class="RktSym">ks</span> and a
failure continuation function <span class="RktSym">kf</span>, and</p></li><li><p>formatters (<span class="RktVal">#f</span>) are given the <span class="RktSym">value</span> to be
formatted.</p></li></ul><p>Subsequent arguments are supplied by the programmer at each use of the
custom extension, and can be used to tweak the behaviour of the
extension on a case-by-case basis.</p><p>For example, let&rsquo;s suppose we didn&rsquo;t want to restrict ourselves to the
single length byte of Pascal-style strings, but wanted instead a more
flexible way of indicating that a certain block of bytes should be
interpreted and rendered as UTF-8 encoded text. We might define a
custom parser/formatter like the following:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define-syntax%29%29" class="RktStxLink" data-pltdoc="x">define-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktSym">utf-8</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._syntax-rules%29%29" class="RktStxLink" data-pltdoc="x">syntax-rules</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Consume entirety of input, decode as UTF-8</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29.__%29%29" class="RktStxLink" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#t</span><span class="hspace">&nbsp;</span><span class="RktSym">input</span><span class="hspace">&nbsp;</span><span class="RktSym">ks</span><span class="hspace">&nbsp;</span><span class="RktSym">kf</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ks</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes-~3estring%2Futf-8%29%29" class="RktValLink" data-pltdoc="x">bytes-&gt;string/utf-8</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-~3ebytes%29%29" class="RktValLink" data-pltdoc="x">bit-string-&gt;bytes</a></span><span class="hspace">&nbsp;</span><span class="RktSym">input</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes%29%29" class="RktValLink" data-pltdoc="x">bytes</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Consume a prefix of the input, decode as UTF-8</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29.__%29%29" class="RktStxLink" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#t</span><span class="hspace">&nbsp;</span><span class="RktSym">input</span><span class="hspace">&nbsp;</span><span class="RktSym">ks</span><span class="hspace">&nbsp;</span><span class="RktSym">kf</span><span class="hspace">&nbsp;</span><span class="RktSym">length-in-bytes</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-case%29%29" class="RktStxLink" data-pltdoc="x">bit-string-case</a></span><span class="hspace">&nbsp;</span><span class="RktSym">input</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">binary</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes%29%29" class="RktValLink" data-pltdoc="x">bytes</a></span><span class="hspace">&nbsp;</span><span class="RktSym">length-in-bytes</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28lib._racket%2Flist..rkt%29._rest%29%29" class="RktValLink" data-pltdoc="x">rest</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">binary</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ks</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes-~3estring%2Futf-8%29%29" class="RktValLink" data-pltdoc="x">bytes-&gt;string/utf-8</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-~3ebytes%29%29" class="RktValLink" data-pltdoc="x">bit-string-&gt;bytes</a></span><span class="hspace">&nbsp;</span><span class="RktSym">body</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28lib._racket%2Flist..rkt%29._rest%29%29" class="RktValLink" data-pltdoc="x">rest</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">kf</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Encode the entire string without length prefix</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29.__%29%29" class="RktStxLink" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._string-~3ebytes%2Futf-8%29%29" class="RktValLink" data-pltdoc="x">string-&gt;bytes/utf-8</a></span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Encode the entire string with a length prefix</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29.__%29%29" class="RktStxLink" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">length-format-options</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/let.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._let%2A%29%29" class="RktStxLink" data-pltdoc="x">let*</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">bs</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._string-~3ebytes%2Futf-8%29%29" class="RktValLink" data-pltdoc="x">string-&gt;bytes/utf-8</a></span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">len</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes-length%29%29" class="RktValLink" data-pltdoc="x">bytes-length</a></span><span class="hspace">&nbsp;</span><span class="RktSym">bs</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string%29%29" class="RktStxLink" data-pltdoc="x">bit-string</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">len</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">length-format-options</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">bs</span><span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">binary</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>A more general <span class="RktSym">utf-8</span> would be able to specify a
length limit as well as a length format. Extending the example in this
way is left as an exercise for the reader.</p></blockquote></blockquote></blockquote><p>The <span class="RktSym">utf-8</span> parser/formatter can then be used in any of four different ways:</p><ul><li><p>In <span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-case%29%29" class="RktStxLink" data-pltdoc="x">bit-string-case</a></span>, as <span class="RktPn">(</span><span class="RktSym">var</span><span class="stt"> </span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">utf-8</span><span class="RktPn">)</span><span class="RktPn">)</span> &ndash;
will take the remainder of the input and UTF-8 decode it to a string.</p></li><li><p>In <span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-case%29%29" class="RktStxLink" data-pltdoc="x">bit-string-case</a></span>, as <span class="RktPn">(</span><span class="RktSym">var</span><span class="stt"> </span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">utf-8</span><span class="stt"> </span><span class="RktVal">123</span><span class="RktPn">)</span><span class="RktPn">)</span> &ndash;
will take the next 123 bytes of the input and UTF-8 decode it to a
string. Note that the length, here <span class="RktVal">123</span>, can come from some
earlier field extracted from the input, leading to a form of dependent
parsing.</p></li><li><p>In <span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string%29%29" class="RktStxLink" data-pltdoc="x">bit-string</a></span>, as <span class="RktPn">(</span><span class="RktSym">val</span><span class="stt"> </span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">utf-8</span><span class="RktPn">)</span><span class="RktPn">)</span> &ndash; will
encode and output the entirety of <span class="RktSym">val</span> as UTF-8.</p></li><li><p>In <span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string%29%29" class="RktStxLink" data-pltdoc="x">bit-string</a></span>, as
<span class="RktPn">(</span><span class="RktSym">val</span><span class="stt"> </span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">utf-8</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">option</span><span class="stt"> </span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span> &ndash; will encode <span class="RktSym">val</span>
as UTF-8, and will prepend the length of the encoded text in the
output. The length will be formatted using the <span class="RktSym">option</span>s, along
the lines of <span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes-length%29%29" class="RktValLink" data-pltdoc="x">bytes-length</a></span><span class="stt"> </span><span class="RktSym">encoded-text</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym"><span class="badlink"><span class="RktValLink">::</span></span></span><span class="stt"> </span><span class="RktSym">option</span><span class="stt"> </span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span>, so
the length can be encoded in any way at all. A recursive use of a
custom formatter could even encode it in a variable-length fashion.</p></li></ul><p>Giving arguments to custom parser/formatters opens the door to
utilities such as variable-length integer codecs, generic zlib-based
compressing codecs, generic encrypting codecs, generic transcoders and
so on.</p><p>Applications of a custom extension macro are rewritten by
<span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-case%29%29" class="RktStxLink" data-pltdoc="x">bit-string-case</a></span> from <span class="RktPn">(</span><span class="RktSym">extension</span><span class="stt"> </span><span class="RktSym">arg</span><span class="stt"> </span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span> to
<span class="RktPn">(</span><span class="RktSym">extension</span><span class="stt"> </span><span class="RktVal">#t</span><span class="stt"> </span><span class="RktSym">input</span><span class="stt"> </span><span class="RktSym">ks</span><span class="stt"> </span><span class="RktSym">kf</span><span class="stt"> </span><span class="RktSym">arg</span><span class="stt"> </span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span>, and by
<span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string%29%29" class="RktStxLink" data-pltdoc="x">bit-string</a></span> to <span class="RktPn">(</span><span class="RktSym">extension</span><span class="stt"> </span><span class="RktVal">#f</span><span class="stt"> </span><span class="RktSym">value</span><span class="stt"> </span><span class="RktSym">arg</span><span class="stt"> </span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span>.</p><h5>4.5.2<tt>&nbsp;</tt><a name="(part._.The_detailed_anatomy_of_a_custom_extension)"></a>The detailed anatomy of a custom extension</h5><p>A custom extension should accept</p><ul><li><p>the boolean flag indicating whether it is being used as a parser or a formatter,</p></li><li><p>additional arguments, depending on whether it is being used as a parser or a formatter, and</p></li><li><p>any other arguments supplied at the time of use.</p></li></ul><p>When used in "parser" mode (with <span class="RktVal">#t</span> as its first argument),
expects a piece of syntax denoting an input bit-string, a "success
continuation" and a "failure continuation" as its second through
fourth arguments. The result of expansion should analyse the input
bit-string as it sees fit. If it decides it has successfully matched a
prefix of the input, it should call the success continuation with two
arguments: the value extracted from the input prefix, and the
remaining unconsumed input (as a bit-string). If, on the other hand,
it decides it cannot match a prefix of the input, it should call the
failure continuation with no arguments.</p><p>When called in "formatter" mode (with <span class="RktVal">#f</span> as its first
argument), it should expect a piece of syntax denoting the value to be
formatted as its second argument. The result of expansion should be an
expression resulting in the encoded form of this value, as a
bit-string.</p><p>The general form, then, of custom extensions, is:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define-syntax%29%29" class="RktStxLink" data-pltdoc="x">define-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktSym">my-custom-extension</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._syntax-rules%29%29" class="RktStxLink" data-pltdoc="x">syntax-rules</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29.__%29%29" class="RktStxLink" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#t</span><span class="hspace">&nbsp;</span><span class="RktSym">input</span><span class="hspace">&nbsp;</span><span class="RktSym">success-k</span><span class="hspace">&nbsp;</span><span class="RktSym">failure-k</span><span class="hspace">&nbsp;</span><span class="RktSym">other-arg</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28quote._~23~25kernel%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">analyze</span><span class="hspace">&nbsp;</span><span class="RktSym">input</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">success-k</span><span class="hspace">&nbsp;</span><span class="RktSym">result-of-analysis</span><span class="hspace">&nbsp;</span><span class="RktSym">remainder-of-input</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">failure-k</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29.__%29%29" class="RktStxLink" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktSym">value</span><span class="hspace">&nbsp;</span><span class="RktSym">other-arg</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">format-value-as-bit-string</span><span class="hspace">&nbsp;</span><span class="RktSym">value</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><h4>4.6<tt>&nbsp;</tt><a name="(part._.Bit_string_utilities)"></a>Bit string utilities</h4><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._bitsyntax/main..rkt)._bit-string~3f))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">bit-string?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any?</span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if its argument is either a <span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span>, a
<span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-slice~3f%29%29" class="RktValLink" data-pltdoc="x">bit-slice?</a></span> or a <span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._splice~3f%29%29" class="RktValLink" data-pltdoc="x">splice?</a></span>. Returns <span class="RktVal">#f</span>
otherwise.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._bitsyntax/main..rkt)._bit-string-length))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-length%29%29" class="RktValDef RktValLink" data-pltdoc="x">bit-string-length</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._integer~3f%29%29" class="RktValLink" data-pltdoc="x">integer?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns the length of its argument, in bits.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._bitsyntax/main..rkt)._bit-string-empty~3f))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-empty~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">bit-string-empty?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> iff its argument&rsquo;s <span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-length%29%29" class="RktValLink" data-pltdoc="x">bit-string-length</a></span> is
zero.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._bitsyntax/main..rkt)._bit-string-equal~3f))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-equal~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">bit-string-equal?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span><span class="RktVar">y</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">y</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> iff the bit sequences described by <span class="RktVar">x</span> and
<span class="RktVar">y</span> are identical.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._bitsyntax/main..rkt)._bit-string-append))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-append%29%29" class="RktValDef RktValLink" data-pltdoc="x">bit-string-append</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">a</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">a</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Appends its arguments in order, producing a new bit string. Uses
<span class="RktSym">splice</span> internally when it can&rsquo;t arrange to return a bit
string previously constructed. (The practical upshot of this is that
you might need to use <span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-~3ebytes%29%29" class="RktValLink" data-pltdoc="x">bit-string-&gt;bytes</a></span> to "flatten" appended
bit-strings from time to time.)</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._bitsyntax/main..rkt)._bit-string-split-at))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-split-at%29%29" class="RktValDef RktValLink" data-pltdoc="x">bit-string-split-at</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span><span class="RktVar">offset</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><table cellspacing="0" cellpadding="0"><tr><td><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span></td></tr></table></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">offset</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._integer~3f%29%29" class="RktValLink" data-pltdoc="x">integer?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Produces two values: the bit-string containing bits
[<span class="RktVal">0</span>..<span class="RktVar">offset</span>) of <span class="RktVar">x</span>, and the bit-string
containing bits [<span class="RktVar">offset</span>..<span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-length%29%29" class="RktValLink" data-pltdoc="x">bit-string-length</a></span><span class="stt"> </span><span class="RktVar">x</span><span class="RktPn">)</span>) of
<span class="RktVar">x</span>. If offset is negative or greater-or-equal-to the number of
bits in <span class="RktVar">x</span>, an error is signalled.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._bitsyntax/main..rkt)._bit-string-split-at-or-false))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-split-at-or-false%29%29" class="RktValDef RktValLink" data-pltdoc="x">bit-string-split-at-or-false</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span><span class="RktVar">offset</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><table cellspacing="0" cellpadding="0"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">offset</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._integer~3f%29%29" class="RktValLink" data-pltdoc="x">integer?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-split-at%29%29" class="RktValLink" data-pltdoc="x">bit-string-split-at</a></span><span class="stt"> </span><span class="RktVar">x</span><span class="stt"> </span><span class="RktVar">offset</span><span class="RktPn">)</span>, but if <span class="RktVar">offset</span>
is out of range returns <span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/values.html#%28def._%28%28quote._~23~25kernel%29._values%29%29" class="RktValLink" data-pltdoc="x">values</a></span><span class="stt"> </span><span class="RktVal">#f</span><span class="stt"> </span><span class="RktVal">#f</span><span class="RktPn">)</span> instead of signalling
an error. This procedure is used in the implementation of
<span class="RktSym"><a href="index.html#%28form._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-case%29%29" class="RktStxLink" data-pltdoc="x">bit-string-case</a></span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._bitsyntax/main..rkt)._bit-string-take))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-take%29%29" class="RktValDef RktValLink" data-pltdoc="x">bit-string-take</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span><span class="RktVar">offset</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">offset</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._integer~3f%29%29" class="RktValLink" data-pltdoc="x">integer?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Retrieves the first <span class="RktVar">offset</span> bits of <span class="RktVar">x</span>. Raises an
exception if <span class="RktVar">offset</span> is out-of-bounds.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._bitsyntax/main..rkt)._bit-string-drop))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-drop%29%29" class="RktValDef RktValLink" data-pltdoc="x">bit-string-drop</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span><span class="RktVar">offset</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">offset</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._integer~3f%29%29" class="RktValLink" data-pltdoc="x">integer?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Discards the first <span class="RktVar">offset</span> bits of <span class="RktVar">x</span>. Raises an
exception if <span class="RktVar">offset</span> is out-of-bounds.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._bitsyntax/main..rkt)._sub-bit-string))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._sub-bit-string%29%29" class="RktValDef RktValLink" data-pltdoc="x">sub-bit-string</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span><span class="RktVar">low-bit</span><span class="hspace">&nbsp;</span><span class="RktVar">high-bit</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">low-bit</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._integer~3f%29%29" class="RktValLink" data-pltdoc="x">integer?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">high-bit</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._integer~3f%29%29" class="RktValLink" data-pltdoc="x">integer?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">If <span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="stt"> </span><span class="RktVal">0</span><span class="stt"> </span><span class="RktVar">low-bit</span><span class="stt"> </span><span class="RktVar">high-bit</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._sub1%29%29" class="RktValLink" data-pltdoc="x">sub1</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-length%29%29" class="RktValLink" data-pltdoc="x">bit-string-length</a></span><span class="stt"> </span><span class="RktVar">x</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span>,
returns the bit-string containing bits
[<span class="RktVar">low-bit</span>..<span class="RktVar">high-bit</span>) of <span class="RktVar">x</span>. Otherwise,
signals an error.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._bitsyntax/main..rkt)._bit-string-ref))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-ref%29%29" class="RktValDef RktValLink" data-pltdoc="x">bit-string-ref</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span><span class="RktVar">offset</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">offset</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._integer~3f%29%29" class="RktValLink" data-pltdoc="x">integer?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Extracts bit number <span class="RktVar">offset</span> from <span class="RktVar">x</span>. Signals an error
if <span class="RktVar">offset</span> is negative or greater-than-or-equal-to the length
of <span class="RktVar">x</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._bitsyntax/main..rkt)._bit-string-~3ebytes))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-~3ebytes%29%29" class="RktValDef RktValLink" data-pltdoc="x">bit-string-&gt;bytes</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Flattens any splices or bit-slices in <span class="RktVar">x</span>, producing a single
contiguous byte vector with <span class="RktVar">x</span>&rsquo;s contents. If
<span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._positive~3f%29%29" class="RktValLink" data-pltdoc="x">positive?</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._remainder%29%29" class="RktValLink" data-pltdoc="x">remainder</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-length%29%29" class="RktValLink" data-pltdoc="x">bit-string-length</a></span><span class="stt"> </span><span class="RktVar">x</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktVal">8</span><span class="RktPn">)</span><span class="RktPn">)</span>, pads out the
remaining bits with zeros on the right.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._bitsyntax/main..rkt)._bit-string-~3ebytes/align))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-~3ebytes%2Falign%29%29" class="RktValDef RktValLink" data-pltdoc="x">bit-string-&gt;bytes/align</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span><span class="RktVar">align-right?</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">align-right?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">As <span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-~3ebytes%29%29" class="RktValLink" data-pltdoc="x">bit-string-&gt;bytes</a></span>, but offers the choice of padding on the
right (if <span class="RktVar">align-right?</span> is <span class="RktVal">#f</span>) or on the left (if
<span class="RktVar">align-right?</span> is <span class="RktVal">#t</span>) when padding is required. (Note
that to align the bits in <span class="RktVar">x</span> on the right is to pad with zeros
on the left, and vice versa.)</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._bitsyntax/main..rkt)._bit-string-byte-count))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-byte-count%29%29" class="RktValDef RktValLink" data-pltdoc="x">bit-string-byte-count</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._integer~3f%29%29" class="RktValLink" data-pltdoc="x">integer?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns the smallest number of whole bytes that could contain all the
bits in <span class="RktVar">x</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._bitsyntax/main..rkt)._bit-string-pack!))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-pack%21%29%29" class="RktValDef RktValLink" data-pltdoc="x">bit-string-pack!</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span><span class="RktVar">buf</span><span class="hspace">&nbsp;</span><span class="RktVar">offset</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/void.html#%28def._%28%28quote._~23~25kernel%29._void~3f%29%29" class="RktValLink" data-pltdoc="x">void?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">buf</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">offset</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._integer~3f%29%29" class="RktValLink" data-pltdoc="x">integer?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Copies the entirety of <span class="RktVar">x</span> into <span class="RktVar">buf</span>, overwriting bits
starting with the <span class="RktVar">offset</span>th. It is an error for <span class="RktVar">buf</span>
not to have enough room or for <span class="RktVar">offset</span> to be out-of-bounds.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._bitsyntax/main..rkt)._bit-string-pack))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-pack%29%29" class="RktValDef RktValLink" data-pltdoc="x">bit-string-pack</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns a bit string equivalent to <span class="RktVar">x</span> (i.e. with exactly the
same bits in the same order) but with any intermediate splices or
bit-slices flattened away. The result will either be a <span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span>
of the correct length, or a <span class="RktSym">bit-slice</span> referring to a section
of a byte vector of length <span class="RktPn">(</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-byte-count%29%29" class="RktValLink" data-pltdoc="x">bit-string-byte-count</a></span><span class="stt"> </span><span class="RktVar">x</span><span class="RktPn">)</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._bitsyntax/main..rkt)._copy-bits!))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._copy-bits%21%29%29" class="RktValDef RktValLink" data-pltdoc="x">copy-bits!</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">target</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">target-offset</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">source</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">source-offset</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">count</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="http://docs.racket-lang.org/reference/void.html#%28def._%28%28quote._~23~25kernel%29._void~3f%29%29" class="RktValLink" data-pltdoc="x">void?</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">target</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">target-offset</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._integer~3f%29%29" class="RktValLink" data-pltdoc="x">integer?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">source</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">source-offset</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._integer~3f%29%29" class="RktValLink" data-pltdoc="x">integer?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">count</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._integer~3f%29%29" class="RktValLink" data-pltdoc="x">integer?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Overwrites bits [<span class="RktVar">target-offset</span>..<span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="stt"> </span><span class="RktVar">target-offset</span><span class="stt"> </span><span class="RktVar">count</span><span class="RktPn">)</span>) of <span class="RktVar">target</span> with bits
[<span class="RktVar">source-offset</span>..<span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="stt"> </span><span class="RktVar">source-offset</span><span class="stt"> </span><span class="RktVar">count</span><span class="RktPn">)</span>) of
<span class="RktVar">source</span>. Undefined behaviour results when <span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._eq~3f%29%29" class="RktValLink" data-pltdoc="x">eq?</a></span><span class="stt"> </span><span class="RktVar">target</span><span class="stt"> </span><span class="RktVar">source</span><span class="RktPn">)</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._bitsyntax/main..rkt)._bit-string-~3einteger))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-~3einteger%29%29" class="RktValDef RktValLink" data-pltdoc="x">bit-string-&gt;integer</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span><span class="RktVar">big-endian?</span><span class="hspace">&nbsp;</span><span class="RktVar">signed?</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._exact-integer~3f%29%29" class="RktValLink" data-pltdoc="x">exact-integer?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">big-endian?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">signed?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Interprets the bits in <span class="RktVar">x</span> as an integer, using either a big-
or little-endian byte-ordering convention (per <span class="RktVar">big-endian?</span>),
and either unsigned or two&rsquo;s-complement signed arithmetic (per
<span class="RktVar">signed?</span>) to produce the result.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._bitsyntax/main..rkt)._bit-string-~3ebyte))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-~3ebyte%29%29" class="RktValDef RktValLink" data-pltdoc="x">bit-string-&gt;byte</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._byte~3f%29%29" class="RktValLink" data-pltdoc="x">byte?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span></td></tr></table></blockquote></div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._bitsyntax/main..rkt)._bit-string-~3esigned-integer))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-~3esigned-integer%29%29" class="RktValDef RktValLink" data-pltdoc="x">bit-string-&gt;signed-integer</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span><span class="RktVar">big-endian?</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._exact-integer~3f%29%29" class="RktValLink" data-pltdoc="x">exact-integer?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">big-endian?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></td></tr></table></blockquote></div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._bitsyntax/main..rkt)._bit-string-~3eunsigned-integer))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-~3eunsigned-integer%29%29" class="RktValDef RktValLink" data-pltdoc="x">bit-string-&gt;unsigned-integer</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">x</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">big-endian?</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._exact-nonnegative-integer~3f%29%29" class="RktValLink" data-pltdoc="x">exact-nonnegative-integer?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">big-endian?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Specialized versions of <span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-~3einteger%29%29" class="RktValLink" data-pltdoc="x">bit-string-&gt;integer</a></span>, giving better
type information for use with Typed Racket.</div></p><p>The function <span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string-~3ebyte%29%29" class="RktValLink" data-pltdoc="x">bit-string-&gt;byte</a></span> will raise an exception if
given a bit string of any length other than exactly eight bits.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._bitsyntax/main..rkt)._integer-~3ebit-string))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._integer-~3ebit-string%29%29" class="RktValDef RktValLink" data-pltdoc="x">integer-&gt;bit-string</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">n</span><span class="hspace">&nbsp;</span><span class="RktVar">width</span><span class="hspace">&nbsp;</span><span class="RktVar">big-endian?</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">n</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._integer~3f%29%29" class="RktValLink" data-pltdoc="x">integer?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">width</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._integer~3f%29%29" class="RktValLink" data-pltdoc="x">integer?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">big-endian?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Encodes <span class="RktVar">n</span> as a bit string of length <span class="RktVar">width</span> bits,
truncating or sign-extending as required, and using a big- or
little-endian byte-ordering convention as per <span class="RktVar">big-endian?</span>.</div></p><h4>4.7<tt>&nbsp;</tt><a name="(part._.Debugging_utilities)"></a>Debugging utilities</h4><p>These procedures may be useful for debugging, but should not be relied
upon otherwise.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._bitsyntax/main..rkt)._bit-slice~3f))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-slice~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">bit-slice?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any?</span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if and only if <span class="RktVar">x</span> is a bit-slice.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._bitsyntax/main..rkt)._bit-slice-binary))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-slice-binary%29%29" class="RktValDef RktValLink" data-pltdoc="x">bit-slice-binary</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-slice~3f%29%29" class="RktValLink" data-pltdoc="x">bit-slice?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Extracts the underlying byte vector from a bit-slice.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._bitsyntax/main..rkt)._bit-slice-low-bit))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-slice-low-bit%29%29" class="RktValDef RktValLink" data-pltdoc="x">bit-slice-low-bit</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._integer~3f%29%29" class="RktValLink" data-pltdoc="x">integer?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-slice~3f%29%29" class="RktValLink" data-pltdoc="x">bit-slice?</a></span></td></tr></table></blockquote></div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._bitsyntax/main..rkt)._bit-slice-high-bit))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-slice-high-bit%29%29" class="RktValDef RktValLink" data-pltdoc="x">bit-slice-high-bit</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._integer~3f%29%29" class="RktValLink" data-pltdoc="x">integer?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-slice~3f%29%29" class="RktValLink" data-pltdoc="x">bit-slice?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Extract the low (inclusive) and high (exclusive) bit indexes,
respectively, from a bit-slice. The bit-slice itself represents bits
[<span class="RktSym">low</span>..<span class="RktSym">high</span>) of the underlying byte vector.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._bitsyntax/main..rkt)._splice~3f))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._splice~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">splice?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any?</span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if and only if <span class="RktVar">x</span> is a splice of two
bit-strings.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._bitsyntax/main..rkt)._splice-left))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._splice-left%29%29" class="RktValDef RktValLink" data-pltdoc="x">splice-left</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._splice~3f%29%29" class="RktValLink" data-pltdoc="x">splice?</a></span></td></tr></table></blockquote></div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._bitsyntax/main..rkt)._splice-right))"></a><span title="Provided from: bitsyntax | Package: bitsyntax"><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._splice-right%29%29" class="RktValDef RktValLink" data-pltdoc="x">splice-right</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._bit-string~3f%29%29" class="RktValLink" data-pltdoc="x">bit-string?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="index.html#%28def._%28%28lib._bitsyntax%2Fmain..rkt%29._splice~3f%29%29" class="RktValLink" data-pltdoc="x">splice?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Extract the left and right bit-strings, respectively, that are spliced
together by the given splice <span class="RktVar">x</span>.</div></p></div></div><div id="contextindicator">&nbsp;</div></body></html>